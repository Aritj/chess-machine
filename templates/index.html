{% extends "layout.html" %}

{% block title %}Chess{% endblock %}

{% block head %}
<script src="{{ url_for('static', filename='js/JQuery-3.6.1.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/chessboard-1.0.0.min.js') }}"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap-5.2.2.min.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/chessboard-1.0.0.min.css') }}">
{{ super() }}
{% endblock %}

{% block content %}
<div>
  <div class="d-flex justify-content-center">
    <button class="btn btn-primary" id="startBtn" style="width: 25%">Reset</button>
  </div>
  <div class="d-flex justify-content-center">
    <div id="board" style="width: 40%"></div>
  </div>
</div>

<script>
  function onDrop(source, target, piece, newPos, oldPos, orientation) {
    if (source != target) {
      $.ajax({
        url: 'move?' + $.param({
          fileFrom: source[0], rankFrom: source[1],
          fileTo: target[0], rankTo: target[1],
          Piece: piece
        }), method: 'POST'
      });
    }
  }

  var board = Chessboard('board', {
    draggable: true,
    position: 'start',
    onDrop: onDrop
  })

  $('#startBtn').on('click', board.start)
</script>
{% endblock %}